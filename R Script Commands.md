# R Script Commands
`setwd('~/Desktop/RStuff/Final/')`## Input data set`PST <- read.csv("~/Desktop/RStuff/Final/Merged.csv", header = TRUE, sep = ",")`## Change the row name to "ID_REF"`rownames(PST) <- NULL``row.names(PST) <- make.names(PST[,1], unique = TRUE)``PST$ID_REF <- NULL`## Remove all rows that sum equals to 0`PST <- PST[which(rowSums(PST) > 0),]`## Transpose the data frame for plotting samples`PST <- t(PST)`## Normalization of extreme value and give the NA value a pseudocount of 0.1`PST <- log10(PST + 0.1)``PST <- as.data.frame(PST)`> ## PCA plot for all samples### Make a column called Samples that has sample IDs in it`PST$Samples <- rownames(PST)`### Make an empty column called Group`PST$Group <- NA`### Create an annotation for PCA plot`ANT <- read.csv("~/Desktop/RStuff/Final/annotation.csv", header = TRUE, sep = ",")`### Group samples`PST$Group <- ifelse(PST$Samples %in% ANT$miRNA.135b_12h_B1, "miRNA-135b_12h_B1",                          ifelse(PST$Samples %in% ANT$miRNA.135b_12h_B2, "miRNA-135b_12h_B2",                                 ifelse(PST$Samples %in% ANT$miRNA.135b_24h_B1, "miRNA-135b_24h_B1",                                        ifelse(PST$Samples %in% ANT$miRNA.135b_24h_B2, "miRNA-135b_24h_B2",                                               ifelse(PST$Samples %in% ANT$miRNA.135b_36h_B1, "miRNA-135b_36h_B1",                                                      ifelse(PST$Samples %in% ANT$miRNA.135b_36h_B2, "miRNA-135b_36h_B2",                                                             ifelse(PST$Samples %in% ANT$Scrambled_12h_B1, "Scrambled_12h_B1",                                                                    ifelse(PST$Samples %in% ANT$Scrambled_12h_B2, "Scrambled_12h_B2",                                                                           ifelse(PST$Samples %in% ANT$Scrambled_24h_B1, "Scrambled_24h_B1",                                                                                  ifelse(PST$Samples %in% ANT$Scrambled_24h_B2, "Scrambled_24h_B2",                                                                                         ifelse(PST$Samples %in% ANT$Scrambled_36h_B1, "Scrambled_36h_B1",                                                                                                ifelse(PST$Samples %in% ANT$Scrambled_36h_B2, "Scrambled_36h_B2", "Unknown"))))))))))))`### Make another dataset that does not include Samples and Group columns`PST.data <- PST[c(1:47323)]`### Plot PCA`library(ggplot2)library(ggfortify)``autoplot(prcomp(PST.data))``autoplot(prcomp(PST.data), data = PST, colour = 'Group', size = 3, main = "Quantile Normalized Values") + theme(text = element_text(size = 15))`> ## PCA plot based on time`PST.time <- as.data.frame(PST[c(1:47323)])`### Make a column called Samples that has sample IDs in it`PST.time$Samples <- rownames(PST.time)`### Make an empty column called Group`PST.time$Group <- NA`### Create an annotation for PCA plot`ANT.time <- read.csv("~/Desktop/RStuff/Final/annotation_time.csv", header = TRUE, sep = ",")`### Group samples`PST.time$Group <- ifelse(PST.time$Samples %in% ANT.time$X12H, "Hour 12",                    ifelse(PST.time$Samples %in% ANT.time$X24H, "Hour 24",                           ifelse(PST.time$Samples %in% ANT.time$X36H, "Hour 36", "Unknown")))`### Make another dataset that does not include Samples and Group columns`PST.time.data <- PST.time[c(1:47323)]`### Plot PCA`autoplot(prcomp(PST.time.data))``autoplot(prcomp(PST.time.data), data = PST.time, colour = 'Group', size = 3, main = "Quantile Normalized Values_Time") + theme(text = element_text(size = 15))`> ## PCA plot based on protocols`PST.ptc <- as.data.frame(PST[c(1:47323)])``PST.ptc$Samples <- rownames(PST.ptc)``PST.ptc$Group <- NA``ANT.ptc <- read.csv("~/Desktop/RStuff/Final/annotation_protocol.csv", header = TRUE, sep = ",")``PST.ptc$Group <- ifelse(PST.ptc$Samples %in% ANT.ptc$miRNA.135b_transfected, "miRNA-135b transfected",                         ifelse(PST.ptc$Samples %in% ANT.ptc$Scrambled_transfected, "Scrambled transfected", "Unknown"))``PST.pct.data <- PST.ptc[c(1:47323)]``autoplot(prcomp(PST.pct.data))`
`autoplot(prcomp(PST.pct.data), data = PST.ptc, colour = 'Group', size = 3, main = "Quantile Normalized Values_Protocol") + theme(text = element_text(size = 15))`> ## Dendrogram`PST.ddg <- as.data.frame(PST[c(1:47323)])``PST.ddg[is.na(PST.ddg)] <- 1.0`### Compute Euclidean distance with the function dist()`PST.dist <- dist(PST.ddg, method = "euclidean")`### Determine the optimal number of cluster for k-means clustering`library(factoextra)``fviz_nbclust(PST.ddg, kmeans, method = "silhouette")`### Perform hierarchical clustering using complete linkage`PST.complete.eucl <- hclust(d = PST.dist, method = "complete")`### Generate a dendrogram cut by 2 clusters with different colors according to their assigned clusters and add rectangular boxes around the clusters`fviz_dend(PST.complete.eucl, k = 2,          labels = TRUE,          k_colors = c("red", "blue"),          color_labels_by_k = TRUE,          rect = TRUE)``